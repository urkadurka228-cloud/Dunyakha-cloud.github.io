<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Clashpoint</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: none;
        }

        body {
            background: #000;
            color: #fff;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        /* –ú–ï–ù–Æ */
        #gameMenu {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            gap: 10px;
        }

        .gameBtn {
            width: 270px;
            height: 55px;
            background: #111;
            border: 3px solid #ff4655;
            border-radius: 8px;
            color: #ff4655;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .gameBtn:hover {
            background: #222;
            transform: scale(1.05);
        }

        .menuSettingsBtn {
            position: absolute;
            bottom: 30px;
            width: 45px;
            height: 45px;
            background: #111;
            border: 2px solid #ff4655;
            border-radius: 8px;
            color: #ff4655;
            font-size: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .menuSettingsBtn:hover {
            background: #222;
        }

        /* –ò–ì–†–´ */
        .gameContainer {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #000;
            display: none;
        }

        .backBtn {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 45px;
            height: 45px;
            background: #ff4655;
            border-radius: 50%;
            color: white;
            border: none;
            font-size: 22px;
            z-index: 1000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .backBtn:hover {
            background: #ff2e3f;
            transform: scale(1.1);
        }

        .gameSettingsBtn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 45px;
            height: 45px;
            background: #111;
            border: 2px solid #ff4655;
            border-radius: 8px;
            color: #ff4655;
            font-size: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .gameSettingsBtn:hover {
            background: #222;
        }

        .stats {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #111;
            padding: 8px 16px;
            border-radius: 8px;
            border: 2px solid #ff4655;
            font-size: 18px;
            color: #ff4655;
            display: flex;
            gap: 15px;
        }

        .highScore {
            color: #ffd700;
        }

        .timer {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 28px;
            color: #ff4655;
            font-weight: bold;
            background: #111;
            padding: 8px 24px;
            border-radius: 8px;
            border: 2px solid #ff4655;
        }

        /* –ò–ì–†–ê 1: –ü–†–ò–¶–ï–õ */
        .target {
            position: absolute;
            width: 55px;
            height: 55px;
            background: radial-gradient(circle, #ff4655 40%, #b5303a 100%);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 20px rgba(255, 70, 85, 0.7);
            cursor: crosshair;
            transition: transform 0.1s;
        }

        .target:hover {
            transform: scale(1.1);
        }

        /* –ò–ì–†–ê 2: –¢–†–ï–ö–ò–ù–ì */
        .trackingCircle {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #4655ff 50%, #303ab5 100%);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 20px rgba(70, 85, 255, 0.7);
            transition: left 0.1s, top 0.1s;
        }

        .trackingCursor {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #4CAF50;
            border-radius: 50%;
            pointer-events: none;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.7);
            background: rgba(76, 175, 80, 0.2);
            z-index: 10;
        }

        /* –ò–ì–†–ê 3: –†–ï–ê–ö–¶–ò–Ø */
        .reactionDot {
            position: absolute;
            width: 75px;
            height: 75px;
            background: radial-gradient(circle, #111 40%, #000 100%);
            border: 4px solid #333;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            transform: translate(-50%, -50%);
        }

        .reactionDot.active {
            background: radial-gradient(circle, #ff4655 40%, #b5303a 100%);
            border-color: white;
            box-shadow: 0 0 30px rgba(255, 70, 85, 0.8);
            transform: translate(-50%, -50%) scale(1.1);
        }

        .reactionDot:hover:not(.active) {
            border-color: #555;
        }

        /* –ò–ì–†–ê 4: –¢–†–ê–ï–ö–¢–û–†–ò–Ø */
        .trajectoryCircle {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #ff55b3 40%, #b5308a 100%);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 25px rgba(255, 85, 179, 0.8);
            cursor: pointer;
            z-index: 5;
            transition: transform 0.1s;
        }

        .trajectoryCircle:hover {
            transform: scale(1.1);
        }

        .trajectoryCursor {
            position: absolute;
            width: 25px;
            height: 25px;
            border: 2px solid #FFD700;
            border-radius: 50%;
            pointer-events: none;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            background: rgba(255, 215, 0, 0.2);
            z-index: 10;
        }

        .trajectoryLine {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.3;
        }

        .trajectoryHint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 85, 179, 0.5);
            font-size: 16px;
            text-align: center;
            pointer-events: none;
            z-index: 2;
        }

        /* –ù–ê–°–¢–†–û–ô–ö–ò */
        #settingsMenu {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .settingsTitle {
            position: absolute;
            top: 30px;
            font-size: 28px;
            color: #ff4655;
        }

        .settingsItem {
            width: 260px;
            padding: 14px;
            margin: 8px;
            background: #111;
            border: 2px solid #ff4655;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .settingsItem:hover {
            background: #222;
            transform: scale(1.05);
        }

        .closeSettings {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            background: #ff4655;
            border-radius: 50%;
            color: white;
            border: none;
            font-size: 22px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .closeSettings:hover {
            background: #ff2e3f;
            transform: scale(1.1);
        }

        /* –ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨ */
        #privacyMenu {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
            z-index: 1001;
        }

        .privacyContent {
            max-width: 90%;
            margin-top: 60px;
            color: #ccc;
            font-size: 14px;
            line-height: 1.5;
            text-align: left;
        }

        .privacyTitle {
            color: #ff4655;
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes pulse {
            0% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
            100% { transform: translateX(-50%) scale(1); }
        }

        .timer.pulse {
            animation: pulse 1s infinite;
        }

        .target.clicked {
            transform: scale(0.8);
            opacity: 0.7;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        /* –ü–†–û–ì–†–ï–°–° –ë–ê–† –î–õ–Ø –¢–†–ê–ï–ö–¢–û–†–ò–ò */
        .progressContainer {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 10px;
            background: #222;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid #ff4655;
        }

        .progressBar {
            height: 100%;
            background: linear-gradient(90deg, #ff55b3, #ff4655);
            width: 0%;
            transition: width 0.3s;
            border-radius: 5px;
        }

        .progressText {
            position: absolute;
            top: 95px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff55b3;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- –ú–ï–ù–Æ -->
    <div id="gameMenu">
        <div class="gameBtn" onclick="startGame('aimTrainer')">–ü–†–ò–¶–ï–õ</div>
        <div class="gameBtn" onclick="startGame('tracking')">–¢–†–ï–ö–ò–ù–ì</div>
        <div class="gameBtn" onclick="startGame('reaction')">–†–ï–ê–ö–¶–ò–Ø</div>
        <div class="gameBtn" onclick="startGame('trajectory')">–¢–†–ê–ï–ö–¢–û–†–ò–Ø</div>
        <button class="menuSettingsBtn" onclick="openSettings()">‚öô</button>
    </div>

    <!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
    <div id="settingsMenu">
        <button class="closeSettings" onclick="closeSettings()">‚úï</button>
        <div class="settingsTitle">–ù–ê–°–¢–†–û–ô–ö–ò</div>
        <div class="settingsItem" onclick="showInfo()">–û –ü–†–û–ï–ö–¢–ï</div>
        <div class="settingsItem" onclick="openPrivacy()">–ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨</div>
        <div class="settingsItem" onclick="resetAll()">–°–ë–†–û–° –†–ï–ö–û–†–î–û–í</div>
        <div class="settingsItem" onclick="closeSettings()">–ó–ê–ö–†–´–¢–¨</div>
    </div>

    <!-- –ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨ -->
    <div id="privacyMenu">
        <button class="closeSettings" onclick="closePrivacy()">‚úï</button>
        <div class="privacyTitle">–ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨</div>
        <div class="privacyContent">
            <p><strong>–ü—Ä–æ–µ–∫—Ç Clashpoint —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.</strong></p>
            <br>
            <p>‚Ä¢ Clashpoint –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–∞–º–∏, –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏</p>
            <p>‚Ä¢ –í—Å–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ç–æ—Ä–≥–æ–≤—ã–µ –º–∞—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∏—Ö –∑–∞–∫–æ–Ω–Ω—ã–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º</p>
            <p>‚Ä¢ –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö —Ü–µ–ª—è—Ö</p>
            <p>‚Ä¢ –ú—ã –Ω–µ —Å–æ–±–∏—Ä–∞–µ–º –∏ –Ω–µ —Ö—Ä–∞–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</p>
            <p>‚Ä¢ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</p>
            <p>‚Ä¢ –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</p>
            <p>‚Ä¢ –î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</p>
            <br>
            <p>–ü—Ä–æ–µ–∫—Ç –Ω–µ –ø—Ä–µ—Ç–µ–Ω–¥—É–µ—Ç –Ω–∞ –∫–∞–∫–∏–µ-–ª–∏–±–æ –ø—Ä–∞–≤–∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü.</p>
        </div>
    </div>

    <!-- –ò–ì–†–ê 1: –ü–†–ò–¶–ï–õ -->
    <div id="aimTrainer" class="gameContainer">
        <button class="backBtn" onclick="backToMenu()">‚Üê</button>
        <button class="gameSettingsBtn" onclick="openSettings()">‚öô</button>
        <div class="stats">
            <span>–û–ß–ö–ò: <span id="aimScore">0</span></span>
            <span class="highScore">üèÜ <span id="aimHighScore">0</span></span>
        </div>
        <div class="timer" id="aimTimer">60</div>
        <div id="aimTargets"></div>
    </div>

    <!-- –ò–ì–†–ê 2: –¢–†–ï–ö–ò–ù–ì -->
    <div id="tracking" class="gameContainer">
        <button class="backBtn" onclick="backToMenu()">‚Üê</button>
        <button class="gameSettingsBtn" onclick="openSettings()">‚öô</button>
        <div class="stats">
            <span>–û–ß–ö–ò: <span id="trackingScore">0</span></span>
            <span class="highScore">üèÜ <span id="trackingHighScore">0</span></span>
        </div>
        <div class="timer" id="trackingTimer">90</div>
        <div class="trackingCursor"></div>
        <div id="trackingArea"></div>
    </div>

    <!-- –ò–ì–†–ê 3: –†–ï–ê–ö–¶–ò–Ø -->
    <div id="reaction" class="gameContainer">
        <button class="backBtn" onclick="backToMenu()">‚Üê</button>
        <button class="gameSettingsBtn" onclick="openSettings()">‚öô</button>
        <div class="stats">
            <span>–û–ß–ö–ò: <span id="reactionScore">0</span></span>
            <span class="highScore">üèÜ <span id="reactionHighScore">0</span></span>
        </div>
        <div class="timer" id="reactionTimer">45</div>
        <div id="reactionDots"></div>
    </div>

    <!-- –ò–ì–†–ê 4: –¢–†–ê–ï–ö–¢–û–†–ò–Ø -->
    <div id="trajectory" class="gameContainer">
        <button class="backBtn" onclick="backToMenu()">‚Üê</button>
        <button class="gameSettingsBtn" onclick="openSettings()">‚öô</button>
        <div class="stats">
            <span>–û–ß–ö–ò: <span id="trajectoryScore">0</span></span>
            <span class="highScore">üèÜ <span id="trajectoryHighScore">0</span></span>
        </div>
        <div class="progressContainer">
            <div class="progressBar" id="trajectoryProgress"></div>
        </div>
        <div class="progressText">–ü–†–û–ì–†–ï–°–°: <span id="progressPercent">0%</span></div>
        <div class="timer" id="trajectoryTimer">75</div>
        <div class="trajectoryCursor"></div>
        <canvas id="trajectoryCanvas" class="trajectoryLine"></canvas>
        <div class="trajectoryHint" id="trajectoryHint">–°–ª–µ–¥–∏ –∑–∞ —Ä–æ–∑–æ–≤–æ–π —Ç–æ—á–∫–æ–π!</div>
        <div id="trajectoryArea"></div>
    </div>

    <script>
        let currentGame = null;
        let gameActive = false;
        let timers = [];
        let animationId = null;

        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ï–ö–û–†–î–û–í
        function saveHighScore(game, score) {
            const key = `clashpoint_high_${game}`;
            const current = parseInt(localStorage.getItem(key) || 0);
            if (score > current) {
                localStorage.setItem(key, score.toString());
                return true;
            }
            return false;
        }

        function getHighScore(game) {
            return localStorage.getItem(`clashpoint_high_${game}`) || 0;
        }

        function updateHighScoreDisplay(game, elementId) {
            const highScore = getHighScore(game);
            document.getElementById(elementId).textContent = highScore;
        }

        // –ù–ê–°–¢–†–û–ô–ö–ò
        function openSettings() {
            document.getElementById('settingsMenu').style.display = 'flex';
        }

        function closeSettings() {
            document.getElementById('settingsMenu').style.display = 'none';
        }

        function openPrivacy() {
            document.getElementById('settingsMenu').style.display = 'none';
            document.getElementById('privacyMenu').style.display = 'flex';
        }

        function closePrivacy() {
            document.getElementById('privacyMenu').style.display = 'none';
            document.getElementById('settingsMenu').style.display = 'flex';
        }

        function showInfo() {
            alert('Clashpoint\n–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n4 —Ä–µ–∂–∏–º–∞ –¥–ª—è —Ä–∞–∑–º–∏–Ω–∫–∏\n\n–ü–†–ò–¶–ï–õ - 60 —Å–µ–∫\n–¢–†–ï–ö–ò–ù–ì - 90 —Å–µ–∫\n–†–ï–ê–ö–¶–ò–Ø - 45 —Å–µ–∫\n–¢–†–ê–ï–ö–¢–û–†–ò–Ø - 75 —Å–µ–∫');
            closeSettings();
        }

        function resetAll() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ä–µ–∫–æ—Ä–¥—ã?')) {
                localStorage.removeItem('clashpoint_high_aim');
                localStorage.removeItem('clashpoint_high_tracking');
                localStorage.removeItem('clashpoint_high_reaction');
                localStorage.removeItem('clashpoint_high_trajectory');
                updateHighScoreDisplay('aim', 'aimHighScore');
                updateHighScoreDisplay('tracking', 'trackingHighScore');
                updateHighScoreDisplay('reaction', 'reactionHighScore');
                updateHighScoreDisplay('trajectory', 'trajectoryHighScore');
                alert('–†–µ–∫–æ—Ä–¥—ã —Å–±—Ä–æ—à–µ–Ω—ã!');
            }
            closeSettings();
        }

        // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function startGame(gameId) {
            document.getElementById('gameMenu').style.display = 'none';
            document.getElementById(gameId).style.display = 'block';
            currentGame = gameId;
            gameActive = true;
            
            stopAllTimers();
            
            switch(gameId) {
                case 'aimTrainer':
                    startAimTrainer();
                    break;
                case 'tracking':
                    startTracking();
                    break;
                case 'reaction':
                    startReaction();
                    break;
                case 'trajectory':
                    startTrajectory();
                    break;
            }
        }

        function backToMenu() {
            if (currentGame) {
                document.getElementById(currentGame).style.display = 'none';
                gameActive = false;
                stopAllTimers();
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }
                currentGame = null;
            }
            document.getElementById('gameMenu').style.display = 'flex';
        }

        function stopAllTimers() {
            timers.forEach(timer => {
                clearInterval(timer);
                clearTimeout(timer);
            });
            timers = [];
        }

        // –ò–ì–†–ê 1: –ü–†–ò–¶–ï–õ
        function startAimTrainer() {
            let score = 0;
            let time = 60;
            const targets = [];
            const minDistance = 80;
            
            document.getElementById('aimScore').textContent = score;
            document.getElementById('aimTimer').textContent = time;
            updateHighScoreDisplay('aim', 'aimHighScore');
            
            createTargets();
            
            const timer = setInterval(() => {
                time--;
                document.getElementById('aimTimer').textContent = time;
                
                if (time <= 10) {
                    document.getElementById('aimTimer').classList.add('pulse');
                }
                
                if (time <= 0) {
                    clearInterval(timer);
                    gameActive = false;
                    document.getElementById('aimTimer').classList.remove('pulse');
                    
                    const beatRecord = saveHighScore('aim', score);
                    setTimeout(() => {
                        let message = `–ü–†–ò–¶–ï–õ\n–û—á–∫–∏: ${score}`;
                        const highScore = getHighScore('aim');
                        message += `\n–†–µ–∫–æ—Ä–¥: ${highScore}`;
                        if (beatRecord) message += "\nüéâ –ù–û–í–´–ô –†–ï–ö–û–†–î!";
                        alert(message);
                        backToMenu();
                    }, 500);
                }
            }, 1000);
            
            timers.push(timer);
            
            function createTargets() {
                const container = document.getElementById('aimTargets');
                container.innerHTML = '';
                
                for(let i = 0; i < 5; i++) {
                    createTarget();
                }
                
                function createTarget() {
                    const target = document.createElement('div');
                    target.className = 'target';
                    
                    let x, y;
                    let attempts = 0;
                    
                    do {
                        x = 60 + Math.random() * (window.innerWidth - 120);
                        y = 100 + Math.random() * (window.innerHeight - 200);
                        attempts++;
                    } while (isTooClose(x, y) && attempts < 50);
                    
                    target.style.left = `${x}px`;
                    target.style.top = `${y}px`;
                    
                    targets.push({x, y, element: target});
                    
                    target.onclick = function() {
                        if (!gameActive || time <= 0) return;
                        
                        score++;
                        document.getElementById('aimScore').textContent = score;
                        
                        this.classList.add('clicked');
                        
                        setTimeout(() => {
                            const index = targets.findIndex(t => t.element === this);
                            if (index > -1) targets.splice(index, 1);
                            
                            let newX, newY;
                            let newAttempts = 0;
                            
                            do {
                                newX = 60 + Math.random() * (window.innerWidth - 120);
                                newY = 100 + Math.random() * (window.innerHeight - 200);
                                newAttempts++;
                            } while (isTooClose(newX, newY) && newAttempts < 50);
                            
                            this.style.left = `${newX}px`;
                            this.style.top = `${newY}px`;
                            this.classList.remove('clicked');
                            
                            targets.push({x: newX, y: newY, element: this});
                        }, 150);
                    };
                    
                    container.appendChild(target);
                }
                
                function isTooClose(x, y) {
                    for (const target of targets) {
                        const distance = Math.sqrt(Math.pow(x - target.x, 2) + Math.pow(y - target.y, 2));
                        if (distance < minDistance) return true;
                    }
                    return false;
                }
            }
        }

        // –ò–ì–†–ê 2: –¢–†–ï–ö–ò–ù–ì
        function startTracking() {
            let score = 0;
            let time = 90;
            
            document.getElementById('trackingScore').textContent = score;
            document.getElementById('trackingTimer').textContent = time;
            updateHighScoreDisplay('tracking', 'trackingHighScore');
            
            const area = document.getElementById('trackingArea');
            area.innerHTML = '';
            
            const circle = document.createElement('div');
            circle.className = 'trackingCircle';
            circle.id = 'trackCircle';
            
            let circleX = 100 + Math.random() * (window.innerWidth - 200);
            let circleY = 150 + Math.random() * (window.innerHeight - 300);
            
            circle.style.left = `${circleX}px`;
            circle.style.top = `${circleY}px`;
            
            area.appendChild(circle);
            
            const cursor = document.querySelector('.trackingCursor');
            
            function handleMove(e) {
                let x, y;
                
                if (e.type === 'touchmove') {
                    e.preventDefault();
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                
                cursor.style.left = `${x}px`;
                cursor.style.top = `${y}px`;
                
                checkCollision(x, y);
            }
            
            document.addEventListener('mousemove', handleMove);
            document.addEventListener('touchmove', handleMove, { passive: false });
            
            const timer = setInterval(() => {
                time--;
                document.getElementById('trackingTimer').textContent = time;
                
                if (time <= 10) {
                    document.getElementById('trackingTimer').classList.add('pulse');
                }
                
                if (time <= 0) {
                    clearInterval(timer);
                    gameActive = false;
                    document.getElementById('trackingTimer').classList.remove('pulse');
                    document.removeEventListener('mousemove', handleMove);
                    document.removeEventListener('touchmove', handleMove);
                    
                    const beatRecord = saveHighScore('tracking', score);
                    setTimeout(() => {
                        let message = `–¢–†–ï–ö–ò–ù–ì\n–û—á–∫–∏: ${score}`;
                        const highScore = getHighScore('tracking');
                        message += `\n–†–µ–∫–æ—Ä–¥: ${highScore}`;
                        if (beatRecord) message += "\nüéâ –ù–û–í–´–ô –†–ï–ö–û–†–î!";
                        alert(message);
                        backToMenu();
                    }, 500);
                }
            }, 1000);
            
            timers.push(timer);
            
            function animateTracking() {
                if (!gameActive || time <= 0) return;
                
                const circle = document.getElementById('trackCircle');
                if (!circle) return;
                
                const moveX = (Math.random() - 0.5) * 15;
                const moveY = (Math.random() - 0.5) * 15;
                
                circleX += moveX;
                circleY += moveY;
                
                if (circleX < 50) circleX = 50;
                if (circleX > window.innerWidth - 50) circleX = window.innerWidth - 50;
                if (circleY < 100) circleY = 100;
                if (circleY > window.innerHeight - 100) circleY = window.innerHeight - 100;
                
                circle.style.left = `${circleX}px`;
                circle.style.top = `${circleY}px`;
                
                const shakeX = (Math.random() - 0.5) * 12;
                const shakeY = (Math.random() - 0.5) * 12;
                
                circle.style.transform = `translate(${shakeX}px, ${shakeY}px)`;
                
                animationId = requestAnimationFrame(animateTracking);
            }
            
            animateTracking();
            
            function checkCollision(cursorX, cursorY) {
                if (!gameActive || time <= 0) return;
                
                const circle = document.getElementById('trackCircle');
                if (!circle) return;
                
                const circleRect = circle.getBoundingClientRect();
                const circleCenterX = circleRect.left + circleRect.width / 2;
                const circleCenterY = circleRect.top + circleRect.height / 2;
                
                const distance = Math.sqrt(
                    Math.pow(circleCenterX - cursorX, 2) + 
                    Math.pow(circleCenterY - cursorY, 2)
                );
                
                if (distance < 40) {
                    score++;
                    document.getElementById('trackingScore').textContent = score;
                    
                    circleX = 100 + Math.random() * (window.innerWidth - 200);
                    circleY = 150 + Math.random() * (window.innerHeight - 300);
                    
                    circle.style.left = `${circleX}px`;
                    circle.style.top = `${circleY}px`;
                }
            }
        }

        // –ò–ì–†–ê 3: –†–ï–ê–ö–¶–ò–Ø
        function startReaction() {
            let score = 0;
            let time = 45;
            
            document.getElementById('reactionScore').textContent = score;
            document.getElementById('reactionTimer').textContent = time;
            updateHighScoreDisplay('reaction', 'reactionHighScore');
            
            createDots();
            
            const timer = setInterval(() => {
                time--;
                document.getElementById('reactionTimer').textContent = time;
                
                if (time <= 10) {
                    document.getElementById('reactionTimer').classList.add('pulse');
                }
                
                if (time <= 0) {
                    clearInterval(timer);
                    clearInterval(dotTimer);
                    gameActive = false;
                    document.getElementById('reactionTimer').classList.remove('pulse');
                    
                    const beatRecord = saveHighScore('reaction', score);
                    setTimeout(() => {
                        let message = `–†–ï–ê–ö–¶–ò–Ø\n–û—á–∫–∏: ${score}`;
                        const highScore = getHighScore('reaction');
                        message += `\n–†–µ–∫–æ—Ä–¥: ${highScore}`;
                        if (beatRecord) message += "\nüéâ –ù–û–í–´–ô –†–ï–ö–û–†–î!";
                        alert(message);
                        backToMenu();
                    }, 500);
                }
            }, 1000);
            
            timers.push(timer);
            
            const dotTimer = setInterval(() => {
                if (!gameActive || time <= 0) return;
                
                const dots = document.querySelectorAll('.reactionDot');
                const inactiveDots = Array.from(dots).filter(dot => !dot.classList.contains('active'));
                
                if (inactiveDots.length === 0) return;
                
                const randomDot = inactiveDots[Math.floor(Math.random() * inactiveDots.length)];
                randomDot.classList.add('active');
                
                setTimeout(() => {
                    if (randomDot.classList.contains('active')) {
                        randomDot.classList.remove('active');
                    }
                }, 1200);
                
            }, 800);
            
            timers.push(dotTimer);
            
            function createDots() {
                const container = document.getElementById('reactionDots');
                container.innerHTML = '';
                
                const positions = [
                    {x: window.innerWidth / 4, y: window.innerHeight / 2},
                    {x: window.innerWidth / 2, y: window.innerHeight / 2},
                    {x: window.innerWidth * 3/4, y: window.innerHeight / 2}
                ];
                
                positions.forEach((pos, index) => {
                    const dot = document.createElement('div');
                    dot.className = 'reactionDot';
                    dot.style.left = `${pos.x}px`;
                    dot.style.top = `${pos.y}px`;
                    
                    dot.onclick = function() {
                        if (!gameActive || time <= 0 || !this.classList.contains('active')) return;
                        
                        score += 2;
                        document.getElementById('reactionScore').textContent = score;
                        this.classList.remove('active');
                    };
                    
                    container.appendChild(dot);
                });
            }
        }

        // –ò–ì–†–ê 4: –¢–†–ê–ï–ö–¢–û–†–ò–Ø
        function startTrajectory() {
            let score = 0;
            let time = 75;
            let progress = 0;
            let totalPathLength = 0;
            let currentPoint = 0;
            let trajectoryPoints = [];
            
            document.getElementById('trajectoryScore').textContent = score;
            document.getElementById('trajectoryTimer').textContent = time;
            updateHighScoreDisplay('trajectory', 'trajectoryHighScore');
            document.getElementById('progressPercent').textContent = '0%';
            document.getElementById('trajectoryProgress').style.width = '0%';
            
            const area = document.getElementById('trajectoryArea');
            area.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º —Ä–æ–∑–æ–≤—É—é —Ç–æ—á–∫—É
            const circle = document.createElement('div');
            circle.className = 'trajectoryCircle';
            circle.id = 'trajectoryCircle';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ —Ü–µ–Ω—Ç—Ä–µ
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight / 2;
            circle.style.left = `${startX}px`;
            circle.style.top = `${startY}px`;
            circle.style.opacity = '1';
            
            area.appendChild(circle);
            
            // –ö—É—Ä—Å–æ—Ä –¥–ª—è —Å–ª–µ–∂–µ–Ω–∏—è
            const cursor = document.querySelector('.trajectoryCursor');
            
            // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–∞–Ω–Ω—É—é —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é
            generateStrangeTrajectory();
            
            // –†–∏—Å—É–µ–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ canvas
            drawTrajectory();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞
            function handleMove(e) {
                let x, y;
                
                if (e.type === 'touchmove') {
                    e.preventDefault();
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                
                cursor.style.left = `${x}px`;
                cursor.style.top = `${y}px`;
                
                checkTrajectoryCollision(x, y);
            }
            
            document.addEventListener('mousemove', handleMove);
            document.addEventListener('touchmove', handleMove, { passive: false });
            
            // –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã
            const timer = setInterval(() => {
                time--;
                document.getElementById('trajectoryTimer').textContent = time;
                
                if (time <= 10) {
                    document.getElementById('trajectoryTimer').classList.add('pulse');
                }
                
                if (time <= 0) {
                    clearInterval(timer);
                    gameActive = false;
                    document.getElementById('trajectoryTimer').classList.remove('pulse');
                    document.removeEventListener('mousemove', handleMove);
                    document.removeEventListener('touchmove', handleMove);
                    
                    const beatRecord = saveHighScore('trajectory', score);
                    setTimeout(() => {
                        let message = `–¢–†–ê–ï–ö–¢–û–†–ò–Ø\n–û—á–∫–∏: ${score}\n–ü—Ä–æ–≥—Ä–µ—Å—Å: ${progress.toFixed(1)}%`;
                        const highScore = getHighScore('trajectory');
                        message += `\n–†–µ–∫–æ—Ä–¥: ${highScore}`;
                        if (beatRecord) message += "\nüéâ –ù–û–í–´–ô –†–ï–ö–û–†–î!";
                        alert(message);
                        backToMenu();
                    }, 500);
                }
            }, 1000);
            
            timers.push(timer);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
            function animateTrajectory() {
                if (!gameActive || time <= 0) return;
                
                currentPoint++;
                if (currentPoint >= trajectoryPoints.length) {
                    currentPoint = 0;
                }
                
                const point = trajectoryPoints[currentPoint];
                const circle = document.getElementById('trajectoryCircle');
                
                if (circle && point) {
                    circle.style.left = `${point.x}px`;
                    circle.style.top = `${point.y}px`;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥—Ä–æ–∂–∞–Ω–∏—è
                    const shakeX = (Math.random() - 0.5) * 8;
                    const shakeY = (Math.random() - 0.5) * 8;
                    circle.style.transform = `translate(${shakeX}px, ${shakeY}px)`;
                }
                
                animationId = requestAnimationFrame(animateTrajectory);
            }
            
            animateTrajectory();
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
            function generateStrangeTrajectory() {
                trajectoryPoints = [];
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                const maxRadius = Math.min(window.innerWidth, window.innerHeight) * 0.4;
                
                // –°–æ–∑–¥–∞–µ–º —Å–ª–æ–∂–Ω—É—é —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
                for (let i = 0; i < 1000; i++) {
                    const t = i / 1000 * Math.PI * 4;
                    
                    // –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å—Ç—Ä–∞–Ω–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
                    const r1 = maxRadius * (0.5 + 0.3 * Math.sin(t * 2));
                    const r2 = maxRadius * (0.3 + 0.2 * Math.cos(t * 3));
                    
                    const x = centerX + r1 * Math.sin(t) + r2 * Math.cos(t * 0.5);
                    const y = centerY + r1 * Math.cos(t * 1.3) + r2 * Math.sin(t * 0.7);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
                    const randomX = (Math.random() - 0.5) * 20;
                    const randomY = (Math.random() - 0.5) * 20;
                    
                    trajectoryPoints.push({
                        x: x + randomX,
                        y: y + randomY
                    });
                }
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â—É—é –¥–ª–∏–Ω—É –ø—É—Ç–∏
                for (let i = 1; i < trajectoryPoints.length; i++) {
                    const dx = trajectoryPoints[i].x - trajectoryPoints[i-1].x;
                    const dy = trajectoryPoints[i].y - trajectoryPoints[i-1].y;
                    totalPathLength += Math.sqrt(dx * dx + dy * dy);
                }
            }
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
            function drawTrajectory() {
                const canvas = document.getElementById('trajectoryCanvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                ctx.strokeStyle = 'rgba(255, 85, 179, 0.3)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                // –†–∏—Å—É–µ–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é
                for (let i = 0; i < trajectoryPoints.length; i++) {
                    const point = trajectoryPoints[i];
                    if (i === 0) {
                        ctx.moveTo(point.x, point.y);
                    } else {
                        ctx.lineTo(point.x, point.y);
                    }
                }
                
                ctx.stroke();
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏ –≤–¥–æ–ª—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
                ctx.fillStyle = 'rgba(255, 85, 179, 0.1)';
                for (let i = 0; i < trajectoryPoints.length; i += 50) {
                    const point = trajectoryPoints[i];
                    ctx.beginPath();
                    ctx.arc(point.x, point.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π
            function checkTrajectoryCollision(cursorX, cursorY) {
                if (!gameActive || time <= 0) return;
                
                const circle = document.getElementById('trajectoryCircle');
                if (!circle) return;
                
                const circleRect = circle.getBoundingClientRect();
                const circleCenterX = circleRect.left + circleRect.width / 2;
                const circleCenterY = circleRect.top + circleRect.height / 2;
                
                const distance = Math.sqrt(
                    Math.pow(circleCenterX - cursorX, 2) + 
                    Math.pow(circleCenterY - cursorY, 2)
                );
                
                if (distance < 35) {
                    // –ù–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏ –∑–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–∞ —Ç–æ—á–∫–µ
                    score++;
                    document.getElementById('trajectoryScore').textContent = score;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                    const segmentLength = totalPathLength / trajectoryPoints.length;
                    const additionalProgress = (segmentLength / totalPathLength) * 100;
                    progress = Math.min(100, progress + additionalProgress);
                    
                    document.getElementById('progressPercent').textContent = `${progress.toFixed(1)}%`;
                    document.getElementById('trajectoryProgress').style.width = `${progress}%`;
                    
                    // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
                    if (progress > 70) {
                        document.getElementById('trajectoryProgress').style.background = 'linear-gradient(90deg, #00ff88, #00cc66)';
                    } else if (progress > 40) {
                        document.getElementById('trajectoryProgress').style.background = 'linear-gradient(90deg, #ffd700, #ffaa00)';
                    }
                    
                    // –ú–∏–≥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏
                    circle.style.boxShadow = '0 0 40px rgba(255, 85, 179, 1)';
                    setTimeout(() => {
                        circle.style.boxShadow = '0 0 25px rgba(255, 85, 179, 0.8)';
                    }, 100);
                }
            }
            
            // –ü—Ä—è—á–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                document.getElementById('trajectoryHint').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('trajectoryHint').style.display = 'none';
                }, 500);
            }, 3000);
        }

        // –û–ë–†–ê–ë–û–¢–ö–ê –†–ï–°–ê–ô–ó–ê
        window.addEventListener('resize', function() {
            if (currentGame === 'tracking' && gameActive) {
                const circle = document.getElementById('trackCircle');
                if (circle) {
                    let circleX = parseFloat(circle.style.left);
                    let circleY = parseFloat(circle.style.top);
                    
                    if (circleX > window.innerWidth - 50) circleX = window.innerWidth - 50;
                    if (circleY > window.innerHeight - 100) circleY = window.innerHeight - 100;
                    
                    circle.style.left = `${circleX}px`;
                    circle.style.top = `${circleY}px`;
                }
            }
            
            if (currentGame === 'trajectory' && gameActive) {
                // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
                const canvas = document.getElementById('trajectoryCanvas');
                if (canvas) {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
            }
        });

        // –ó–ê–ü–†–ï–¢ –ö–û–ù–¢–ï–ö–°–¢–ù–û–ì–û –ú–ï–ù–Æ
        document.addEventListener('contextmenu', e => e.preventDefault());
        
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –†–ï–ö–û–†–î–û–í –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        window.addEventListener('DOMContentLoaded', function() {
            updateHighScoreDisplay('aim', 'aimHighScore');
            updateHighScoreDisplay('tracking', 'trackingHighScore');
            updateHighScoreDisplay('reaction', 'reactionHighScore');
            updateHighScoreDisplay('trajectory', 'trajectoryHighScore');
        });
    </script>
</body>
</html>
