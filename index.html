<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minecraft Clicker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }
        
        body {
            background-color: #1a1a2e;
            color: white;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #game-container {
            width: 100%;
            height: 100%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
        }
        
        /* Меню */
        #menu-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #0f4c75, #1b262c);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            transition: opacity 0.5s;
        }
        
        .menu-title {
            font-size: 3.5rem;
            color: #ffd700;
            margin-bottom: 2rem;
            text-align: center;
            text-shadow: 3px 3px 0 #8b4513, 5px 5px 0 #000;
            letter-spacing: 2px;
            font-family: 'Minecraft', monospace;
        }
        
        .play-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 1.2rem 3rem;
            font-size: 1.8rem;
            border-radius: 15px;
            cursor: pointer;
            margin-top: 2rem;
            box-shadow: 0 6px 0 #3e8e41, 0 10px 20px rgba(0,0,0,0.5);
            transition: all 0.1s;
            font-weight: bold;
        }
        
        .play-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #3e8e41, 0 5px 10px rgba(0,0,0,0.5);
        }
        
        .privacy-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: 2px solid #fff;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        /* Игровой экран */
        #game-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #87CEEB, #1E90FF);
            display: none;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            z-index: 5;
        }
        
        .game-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .coins-container {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        .coin-icon {
            width: 24px;
            height: 24px;
            background: radial-gradient(circle at 30% 30%, #FFD700, #B8860B);
            border-radius: 50%;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .coin-icon::after {
            content: '';
            position: absolute;
            top: 5px;
            left: 8px;
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
        }
        
        .shop-btn {
            background: linear-gradient(45deg, #8B4513, #A0522D);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 3px 0 #654321;
            transition: all 0.1s;
        }
        
        .shop-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 #654321;
        }
        
        .current-block-info {
            font-size: 1.2rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        .click-counter {
            font-size: 1.2rem;
            color: #fff;
            font-weight: bold;
        }
        
        .block-container {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            position: relative;
        }
        
        .block {
            width: 220px;
            height: 220px;
            position: relative;
            cursor: pointer;
            transition: transform 0.05s;
            user-select: none;
            border-radius: 5px;
        }
        
        .block.hit {
            animation: hitEffect 0.1s ease-out;
        }
        
        .block.regenerating {
            animation: regeneratingEffect 2s infinite;
        }
        
        .block-img {
            width: 100%;
            height: 100%;
            border-radius: 5px;
            box-shadow: 
                0 10px 20px rgba(0,0,0,0.5),
                inset 0 0 20px rgba(0,0,0,0.2);
            border: 5px solid;
            image-rendering: pixelated;
        }
        
        .cracks-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            z-index: 2;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
        }
        
        .regeneration-indicator {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(76, 175, 80, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            display: none;
            z-index: 10;
        }
        
        .progress-bar-container {
            width: 90%;
            height: 25px;
            background-color: #333;
            border-radius: 12px;
            margin-bottom: 25px;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            border: 2px solid #8b4513;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.2s;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,0.3) 50%, 
                transparent 100%);
            animation: shine 2s infinite;
        }
        
        .block-name {
            font-size: 2rem;
            color: #fff;
            margin-bottom: 15px;
            text-shadow: 2px 2px 0 #000;
            text-align: center;
            font-family: 'Minecraft', monospace;
        }
        
        .health-display {
            font-size: 1.5rem;
            color: #ff6b6b;
            font-weight: bold;
            margin-top: 10px;
            text-shadow: 1px 1px 0 #000;
        }
        
        .coin-hit-animation {
            position: absolute;
            font-size: 1.5rem;
            color: #FFD700;
            font-weight: bold;
            pointer-events: none;
            z-index: 10;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            animation: coinHitFloat 1s ease-out forwards;
        }
        
        .auto-clicker-info {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #4CAF50;
            display: none;
        }
        
        /* Магазин */
        #shop-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #2c3e50, #1a1a2e);
            display: none;
            flex-direction: column;
            padding: 20px;
            z-index: 15;
        }
        
        .shop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .shop-title {
            font-size: 2rem;
            color: #ffd700;
            font-family: 'Minecraft', monospace;
        }
        
        .back-btn {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 3px 0 #b71c1c;
        }
        
        .shop-items {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .shop-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid #8B4513;
        }
        
        .item-title {
            font-size: 1.3rem;
            color: #4CAF50;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .item-price {
            color: #FFD700;
            font-weight: bold;
        }
        
        .item-description {
            font-size: 0.9rem;
            color: #ccc;
            margin-bottom: 10px;
        }
        
        .buy-btn {
            background: linear-gradient(45deg, #4CAF50, #388E3C);
            color: white;
            border: none;
            padding: 10px 20px;
            width: 100%;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .buy-btn:disabled {
            background: linear-gradient(45deg, #757575, #616161);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .buy-btn:not(:disabled):hover {
            background: linear-gradient(45deg, #66BB6A, #43A047);
        }
        
        .owned-badge {
            background-color: #2196F3;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
        }
        
        /* Анимации */
        @keyframes hitEffect {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
        
        @keyframes regeneratingEffect {
            0% { box-shadow: 0 0 0 rgba(76, 175, 80, 0.5); }
            50% { box-shadow: 0 0 20px rgba(76, 175, 80, 0.8); }
            100% { box-shadow: 0 0 0 rgba(76, 175, 80, 0.5); }
        }
        
        @keyframes breakBlock {
            0% { transform: scale(1); opacity: 1; filter: brightness(1); }
            50% { transform: scale(1.1); opacity: 0.8; filter: brightness(1.5); }
            100% { transform: scale(0); opacity: 0; filter: brightness(2); }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes coinHitFloat {
            0% { 
                transform: translateY(0) scale(1); 
                opacity: 1; 
            }
            50% { 
                transform: translateY(-40px) scale(1.2); 
                opacity: 0.8; 
            }
            100% { 
                transform: translateY(-80px) scale(0.5); 
                opacity: 0; 
            }
        }
        
        @keyframes coinPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes autoClickerPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Модальное окно конфиденциальности */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 20;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: #1b262c;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 80%;
            overflow-y: auto;
            border: 3px solid #4CAF50;
        }
        
        .modal-title {
            font-size: 1.8rem;
            color: #ffd700;
            margin-bottom: 1rem;
        }
        
        .modal-text {
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }
        
        .close-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
        }
        
        /* Фон с пиксельной тематикой Minecraft */
        .minecraft-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 90% 80%, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 1;
        }
        
        .ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(to top, #8B4513, #A0522D);
            z-index: 2;
        }
        
        .cloud {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            z-index: 0;
        }
        
        .cloud:nth-child(1) {
            width: 100px;
            height: 40px;
            top: 20%;
            left: 10%;
        }
        
        .cloud:nth-child(2) {
            width: 150px;
            height: 60px;
            top: 15%;
            right: 15%;
        }
        
        .cloud:nth-child(3) {
            width: 80px;
            height: 30px;
            top: 30%;
            left: 60%;
        }
        
        /* Адаптивность */
        @media (max-width: 500px) {
            .block {
                width: 190px;
                height: 190px;
            }
            
            .menu-title {
                font-size: 2.8rem;
            }
            
            .play-btn {
                padding: 1rem 2.5rem;
                font-size: 1.5rem;
            }
            
            .block-name {
                font-size: 1.7rem;
            }
            
            .game-header {
                padding: 10px;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .coins-container {
                font-size: 1.1rem;
            }
            
            .shop-title {
                font-size: 1.7rem;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Фон -->
        <div class="minecraft-bg"></div>
        <div class="cloud"></div>
        <div class="cloud"></div>
        <div class="cloud"></div>
        <div class="ground"></div>
        
        <!-- Экран меню -->
        <div id="menu-screen">
            <h1 class="menu-title">MINECRAFT CLICKER</h1>
            <button class="play-btn" id="play-btn">ИГРАТЬ</button>
            <button class="privacy-btn" id="privacy-btn">Конфиденциальность</button>
        </div>
        
        <!-- Игровой экран -->
        <div id="game-screen">
            <div class="game-header">
                <div class="coins-container">
                    <div class="coin-icon"></div>
                    <span id="coins-counter">0</span>
                </div>
                <button class="shop-btn" id="shop-btn">Магазин</button>
                <div class="click-counter" id="click-counter">Здоровье: 15/15</div>
            </div>
            
            <div class="block-name" id="block-name">Земля</div>
            <div class="health-display" id="health-display"></div>
            
            <div class="block-container">
                <div class="block" id="block">
                    <img src="" alt="Блок" class="block-img" id="block-img">
                    <div class="cracks-overlay" id="cracks-overlay"></div>
                    <div class="regeneration-indicator" id="regeneration-indicator">Регенерация!</div>
                </div>
            </div>
            
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="auto-clicker-info" id="auto-clicker-info"></div>
        </div>
        
        <!-- Магазин -->
        <div id="shop-screen">
            <div class="shop-header">
                <h2 class="shop-title">Магазин</h2>
                <button class="back-btn" id="back-btn">Назад</button>
            </div>
            
            <div class="shop-items">
                <div class="shop-item">
                    <div class="item-title">
                        Автокликер
                        <span class="item-price" id="clicker-price">5000 монет</span>
                    </div>
                    <div class="item-description">
                        Автоматически кликает по блоку каждые 5 секунд. Экономит ваше время!
                    </div>
                    <button class="buy-btn" id="buy-clicker-btn">Купить</button>
                </div>
                
                <div class="shop-item">
                    <div class="item-title">
                        Усилитель удара
                        <span class="item-price" id="damage-price">15000 монет</span>
                    </div>
                    <div class="item-description">
                        Увеличивает урон от каждого клика в 3 раза. Ломайте блоки быстрее!
                    </div>
                    <button class="buy-btn" id="buy-damage-btn">Купить</button>
                </div>
                
                <div class="shop-item">
                    <div class="item-title">
                        Множитель монет
                        <span class="item-price" id="multiplier-price">8000 монет</span>
                    </div>
                    <div class="item-description">
                        Увеличивает количество получаемых монет в 2 раза.
                    </div>
                    <button class="buy-btn" id="buy-multiplier-btn">Купить</button>
                </div>
                
                <div class="shop-item">
                    <div class="item-title">
                        Анти-регенерация
                        <span class="item-price" id="antiregen-price">12000 монет</span>
                    </div>
                    <div class="item-description">
                        Блокирует регенерацию блоков. Больше не нужно спешить!
                    </div>
                    <button class="buy-btn" id="buy-antiregen-btn">Купить</button>
                </div>
                
                <div class="shop-item">
                    <div class="item-title">
                        Удача
                        <span class="item-price" id="luck-price">10000 монет</span>
                    </div>
                    <div class="item-description">
                        Увеличивает шанс выпадения монет до 100% и увеличивает максимальное количество монет.
                    </div>
                    <button class="buy-btn" id="buy-luck-btn">Купить</button>
                </div>
            </div>
        </div>
        
        <!-- Модальное окно конфиденциальности -->
        <div class="modal" id="privacy-modal">
            <div class="modal-content">
                <h2 class="modal-title">Политика конфиденциальности</h2>
                <div class="modal-text">
                    <p>Эта игра "Minecraft Clicker" не собирает и не хранит какие-либо персональные данные пользователей.</p>
                    <p>Игра работает полностью в вашем браузере и не требует подключения к интернету после загрузки.</p>
                    <p>Все данные о прогрессе в игре сохраняются локально в вашем браузере и не передаются на сервер.</p>
                    <p>Если у вас есть вопросы, вы можете связаться с нами по электронной почте: example@example.com</p>
                </div>
                <button class="close-btn" id="close-modal-btn">Закрыть</button>
            </div>
        </div>
    </div>

    <script>
        // Элементы DOM
        const menuScreen = document.getElementById('menu-screen');
        const gameScreen = document.getElementById('game-screen');
        const shopScreen = document.getElementById('shop-screen');
        const playBtn = document.getElementById('play-btn');
        const shopBtn = document.getElementById('shop-btn');
        const backBtn = document.getElementById('back-btn');
        const privacyBtn = document.getElementById('privacy-btn');
        const block = document.getElementById('block');
        const blockImg = document.getElementById('block-img');
        const cracksOverlay = document.getElementById('cracks-overlay');
        const clickCounter = document.getElementById('click-counter');
        const blockName = document.getElementById('block-name');
        const healthDisplay = document.getElementById('health-display');
        const progressBar = document.getElementById('progress-bar');
        const privacyModal = document.getElementById('privacy-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const coinsCounter = document.getElementById('coins-counter');
        const autoClickerInfo = document.getElementById('auto-clicker-info');
        const regenerationIndicator = document.getElementById('regeneration-indicator');
        
        // Элементы магазина
        const buyClickerBtn = document.getElementById('buy-clicker-btn');
        const buyDamageBtn = document.getElementById('buy-damage-btn');
        const buyMultiplierBtn = document.getElementById('buy-multiplier-btn');
        const buyAntiregenBtn = document.getElementById('buy-antiregen-btn');
        const buyLuckBtn = document.getElementById('buy-luck-btn');
        
        // Игровые переменные
        let currentBlock = 0;
        let currentHealth = 0;
        let maxHealth = 0;
        let isBreaking = false;
        let coins = 0;
        let autoClickerActive = false;
        let damageMultiplier = 1;
        let coinMultiplier = 1;
        let antiRegenActive = false;
        let luckActive = false;
        let autoClickerInterval = null;
        let regenerationInterval = null;
        let regenerationTimer = null;
        let lastHitTime = Date.now();
        let isTouching = false;
        
        // Данные о блоках (с новыми блоками)
        const blocks = [
            {
                name: "Земля",
                type: "Земля",
                maxHealth: 15,
                color: "#8B4513",
                innerColor: "#A0522D",
                borderColor: "#654321",
                borderSize: "8px",
                coinRange: {min: 1, max: 5},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M70,70 L80,85 M100,50 L110,65 M130,85 L120,100 M60,110 L75,125 M90,140 L100,155 M120,170 L110,185 M160,60 L170,80 M180,110 L170,130 M190,85 L180,100 M135,190 L125,175 M90,170 L100,185 M175,170 L185,155 M50,135 L65,150' stroke='%23333' stroke-width='3' stroke-opacity='0.4' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M50,50 L65,70 M90,30 L105,50 M120,70 L105,90 M40,100 L55,120 M75,130 L90,150 M110,160 L95,180 M150,40 L165,65 M175,100 L160,120 M200,70 L185,90 M140,200 L125,180 M80,160 L95,180 M170,160 L185,140 M30,125 L45,145 M110,40 L125,60 M180,180 L165,160' stroke='%23333' stroke-width='4' stroke-opacity='0.6' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M40,40 L60,65 M80,20 L100,45 M110,60 L90,85 M30,90 L50,115 M65,120 L85,145 M95,150 L75,175 M140,30 L160,55 M165,90 L145,115 M190,60 L170,85 M130,200 L110,175 M70,150 L90,175 M160,150 L180,125 M20,115 L40,140 M100,30 L120,55 M170,180 L150,155 M50,170 L70,195' stroke='%23333' stroke-width='5' stroke-opacity='0.8' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Дерево",
                type: "Дерево",
                maxHealth: 25,
                color: "#8B4513",
                innerColor: "#D49F31",
                borderColor: "#733B0A",
                borderSize: "8px",
                coinRange: {min: 1, max: 5},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M60,60 L70,75 M90,40 L100,55 M120,75 L110,90 M50,100 L65,115 M80,130 L90,145 M110,160 L100,175 M150,50 L160,70 M170,100 L160,120 M180,75 L170,90 M125,180 L115,165 M80,160 L90,175 M165,160 L175,145 M40,125 L55,140' stroke='%23000' stroke-width='3' stroke-opacity='0.3' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M40,40 L55,60 M80,20 L95,40 M110,60 L95,80 M30,90 L45,110 M65,120 L80,140 M100,150 L85,170 M140,30 L155,55 M165,90 L150,110 M190,60 L175,80 M130,190 L115,170 M70,150 L85,170 M160,150 L175,130 M20,115 L35,135 M100,30 L115,50 M170,170 L155,150' stroke='%23000' stroke-width='4' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M30,30 L50,55 M70,10 L90,35 M100,50 L80,75 M20,80 L40,105 M55,110 L75,135 M90,140 L70,165 M130,20 L150,50 M155,80 L135,105 M180,45 L160,70 M120,200 L100,175 M60,140 L80,165 M150,140 L170,115 M10,105 L30,130 M90,10 L110,35 M160,180 L140,155 M50,170 L70,195' stroke='%23000' stroke-width='5' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Камень",
                type: "Камень",
                maxHealth: 50,
                color: "#808080",
                innerColor: "#A0A0A0",
                borderColor: "#606060",
                borderSize: "8px",
                coinRange: {min: 1, max: 5},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M75,75 L85,90 M105,55 L115,70 M135,90 L125,105 M65,115 L80,130 M95,145 L105,160 M125,175 L115,190 M165,65 L175,85 M185,115 L175,135 M195,90 L185,105 M140,195 L130,180 M95,175 L105,190 M180,175 L190,160 M55,140 L70,155' stroke='%23555' stroke-width='3' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M55,55 L70,75 M95,35 L110,55 M135,75 L120,95 M45,105 L60,125 M80,135 L95,155 M115,165 L100,185 M155,45 L170,70 M180,105 L165,125 M205,75 L190,95 M145,205 L130,185 M85,165 L100,185 M175,165 L190,145 M35,130 L50,150 M115,45 L130,65 M185,185 L170,165' stroke='%23555' stroke-width='4' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M45,45 L65,70 M85,25 L105,50 M115,65 L95,90 M35,95 L55,120 M70,125 L90,150 M100,155 L80,180 M145,35 L165,60 M170,95 L150,120 M195,65 L175,90 M135,205 L115,180 M75,155 L95,180 M165,155 L185,130 M25,120 L45,145 M105,35 L125,60 M175,185 L155,160 M55,175 L75,200' stroke='%23555' stroke-width='5' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Уголь",
                type: "Уголь",
                maxHealth: 100,
                color: "#2F4F4F",
                innerColor: "#363636",
                borderColor: "#1C1C1C",
                borderSize: "8px",
                coinRange: {min: 1, max: 5},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M80,80 L90,95 M110,60 L120,75 M140,95 L130,110 M70,120 L85,135 M100,150 L110,165 M130,180 L120,195 M170,70 L180,90 M190,120 L180,140 M200,95 L190,110 M145,200 L135,185 M100,180 L110,195 M185,180 L195,165 M60,145 L75,160' stroke='%23000' stroke-width='3' stroke-opacity='0.6' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M60,60 L75,80 M100,40 L115,60 M140,80 L125,100 M50,110 L65,130 M85,140 L100,160 M120,170 L105,190 M160,50 L175,75 M185,110 L170,130 M210,80 L195,100 M150,210 L135,190 M90,170 L105,190 M180,170 L195,150 M40,135 L55,155 M120,50 L135,70 M190,190 L175,170' stroke='%23000' stroke-width='4' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M50,50 L70,75 M90,30 L110,55 M120,70 L100,95 M40,100 L60,125 M75,130 L95,155 M105,160 L85,185 M150,40 L170,65 M175,100 L155,125 M200,70 L180,95 M140,210 L120,185 M80,160 L100,185 M170,160 L190,135 M30,125 L50,150 M110,40 L130,65 M180,190 L160,165 M60,180 L80,205' stroke='%23000' stroke-width='5' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Железо",
                type: "Железо",
                maxHealth: 175,
                color: "#D1D1D1",
                innerColor: "#B0B0B0",
                borderColor: "#888888",
                borderSize: "10px",
                coinRange: {min: 5, max: 10},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M85,85 L95,100 M115,65 L125,80 M145,100 L135,115 M75,125 L90,140 M105,155 L115,170 M135,185 L125,200 M175,75 L185,95 M195,125 L185,145 M205,100 L195,115 M150,205 L140,190 M105,185 L115,200 M190,185 L200,170 M65,150 L80,165' stroke='%23666' stroke-width='4' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M65,65 L80,85 M105,45 L120,65 M145,85 L130,105 M55,115 L70,135 M90,145 L105,165 M125,175 L110,195 M165,55 L180,80 M190,115 L175,135 M215,85 L200,105 M155,215 L140,195 M95,175 L110,195 M185,175 L200,155 M45,140 L60,160 M125,55 L140,75 M195,195 L180,175' stroke='%23666' stroke-width='5' stroke-opacity='0.7' fill='none'/%3E%3Csvg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M55,55 L75,80 M95,35 L115,60 M125,75 L105,100 M45,105 L65,130 M80,135 L100,160 M110,165 L90,190 M155,45 L175,70 M180,105 L160,130 M205,75 L185,100 M145,215 L125,190 M85,165 L105,190 M175,165 L195,140 M35,130 L55,155 M115,45 L135,70 M185,195 L165,170 M65,185 L85,210' stroke='%23666' stroke-width='6' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Медь",
                type: "Медь",
                maxHealth: 130,
                color: "#B87333",
                innerColor: "#DA8A67",
                borderColor: "#8B4513",
                borderSize: "10px",
                coinRange: {min: 5, max: 10},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M80,80 L90,95 M110,60 L120,75 M140,95 L130,110 M70,120 L85,135 M100,150 L110,165 M130,180 L120,195 M170,70 L180,90 M190,120 L180,140 M200,95 L190,110 M145,200 L135,185 M100,180 L110,195 M185,180 L195,165 M60,145 L75,160' stroke='%238B4513' stroke-width='4' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M60,60 L75,80 M100,40 L115,60 M140,80 L125,100 M50,110 L65,130 M85,140 L100,160 M120,170 L105,190 M160,50 L175,75 M185,110 L170,130 M210,80 L195,100 M150,210 L135,190 M90,170 L105,190 M180,170 L195,150 M40,135 L55,155 M120,50 L135,70 M190,190 L175,170' stroke='%238B4513' stroke-width='5' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M50,50 L70,75 M90,30 L110,55 M120,70 L100,95 M40,100 L60,125 M75,130 L95,155 M105,160 L85,185 M150,40 L170,65 M175,100 L155,125 M200,70 L180,95 M140,210 L120,185 M80,160 L100,185 M170,160 L190,135 M30,125 L50,150 M110,40 L130,65 M180,190 L160,165 M60,180 L80,205' stroke='%238B4513' stroke-width='6' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Золото",
                type: "Золото",
                maxHealth: 250,
                color: "#FFD700",
                innerColor: "#FFEC8B",
                borderColor: "#B8860B",
                borderSize: "12px",
                coinRange: {min: 5, max: 10},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M90,90 L100,105 M120,70 L130,85 M150,105 L140,120 M80,130 L95,145 M110,160 L120,175 M140,190 L130,205 M180,80 L190,100 M200,130 L190,150 M210,105 L200,120 M155,210 L145,195 M110,190 L120,205 M195,190 L205,175 M70,155 L85,170' stroke='%23B8860B' stroke-width='4' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M70,70 L85,90 M110,50 L125,70 M150,90 L135,110 M60,120 L75,140 M95,150 L110,170 M130,180 L115,200 M170,60 L185,85 M195,120 L180,140 M220,90 L205,110 M160,220 L145,200 M100,180 L115,200 M190,180 L205,160 M50,145 L65,165 M130,60 L145,80 M200,200 L185,180' stroke='%23B8860B' stroke-width='5' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M60,60 L80,85 M100,40 L120,65 M130,80 L110,105 M50,110 L70,135 M85,140 L105,165 M115,170 L95,195 M160,50 L180,75 M185,110 L165,135 M210,80 L190,105 M150,220 L130,195 M90,170 L110,195 M180,170 L200,145 M40,135 L60,160 M120,50 L140,75 M190,200 L170,175 M70,190 L90,215' stroke='%23B8860B' stroke-width='6' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            },
            {
                name: "Платина",
                type: "Платина",
                maxHealth: 300,
                color: "#E5E4E2",
                innerColor: "#FFFFFF",
                borderColor: "#C0C0C0",
                borderSize: "12px",
                coinRange: {min: 5, max: 10},
                crackLevels: [
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M90,90 L100,105 M120,70 L130,85 M150,105 L140,120 M80,130 L95,145 M110,160 L120,175 M140,190 L130,205 M180,80 L190,100 M200,130 L190,150 M210,105 L200,120 M155,210 L145,195 M110,190 L120,205 M195,190 L205,175 M70,155 L85,170' stroke='%23C0C0C0' stroke-width='4' stroke-opacity='0.5' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M70,70 L85,90 M110,50 L125,70 M150,90 L135,110 M60,120 L75,140 M95,150 L110,170 M130,180 L115,200 M170,60 L185,85 M195,120 L180,140 M220,90 L205,110 M160,220 L145,200 M100,180 L115,200 M190,180 L205,160 M50,145 L65,165 M130,60 L145,80 M200,200 L185,180' stroke='%23C0C0C0' stroke-width='5' stroke-opacity='0.7' fill='none'/%3E%3C/svg%3E",
                    "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cpath d='M60,60 L80,85 M100,40 L120,65 M130,80 L110,105 M50,110 L70,135 M85,140 L105,165 M115,170 L95,195 M160,50 L180,75 M185,110 L165,135 M210,80 L190,105 M150,220 L130,195 M90,170 L110,195 M180,170 L200,145 M40,135 L60,160 M120,50 L140,75 M190,200 L170,175 M70,190 L90,215' stroke='%23C0C0C0' stroke-width='6' stroke-opacity='0.9' fill='none'/%3E%3C/svg%3E"
                ]
            }
        ];
        
        // Магазин - товары
        const shopItems = [
            {
                id: 'clicker',
                name: 'Автокликер',
                price: 5000,
                description: 'Автоматически кликает по блоку каждые 5 секунд. Экономит ваше время!',
                owned: false
            },
            {
                id: 'damage',
                name: 'Усилитель удара',
                price: 15000,
                description: 'Увеличивает урон от каждого клика в 3 раза. Ломайте блоки быстрее!',
                owned: false
            },
            {
                id: 'multiplier',
                name: 'Множитель монет',
                price: 8000,
                description: 'Увеличивает количество получаемых монет в 2 раза.',
                owned: false
            },
            {
                id: 'antiregen',
                name: 'Анти-регенерация',
                price: 12000,
                description: 'Блокирует регенерацию блоков. Больше не нужно спешить!',
                owned: false
            },
            {
                id: 'luck',
                name: 'Удача',
                price: 10000,
                description: 'Увеличивает шанс выпадения монет до 100% и увеличивает максимальное количество монет.',
                owned: false
            }
        ];
        
        // Создание изображения блока через SVG
        function createBlockSVG() {
            const blockData = blocks[currentBlock];
            const svgCode = `
                <svg width="220" height="220" viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <filter id="blockShadow">
                            <feDropShadow dx="0" dy="4" stdDeviation="4" flood-opacity="0.5"/>
                        </filter>
                        <pattern id="blockPattern" patternUnits="userSpaceOnUse" width="20" height="20">
                            <rect width="20" height="20" fill="${blockData.color}" opacity="0.3"/>
                            <rect x="10" y="0" width="10" height="10" fill="${blockData.innerColor}" opacity="0.2"/>
                            <rect x="0" y="10" width="10" height="10" fill="${blockData.innerColor}" opacity="0.2"/>
                        </pattern>
                    </defs>
                    <rect width="220" height="220" fill="${blockData.color}" filter="url(#blockShadow)" rx="5"/>
                    <rect x="20" y="20" width="180" height="180" fill="${blockData.innerColor}" rx="3"/>
                    <rect x="10" y="10" width="200" height="200" fill="url(#blockPattern)" opacity="0.4" rx="5"/>
                    <rect width="220" height="220" fill="none" stroke="${blockData.borderColor}" stroke-width="${blockData.borderSize}" rx="5"/>
                </svg>
            `;
            
            const svgBlob = new Blob([svgCode], {type: 'image/svg+xml'});
            const svgUrl = URL.createObjectURL(svgBlob);
            blockImg.src = svgUrl;
            
            // Устанавливаем цвет границы
            blockImg.style.borderColor = blockData.borderColor;
            
            // Загрузка изображения трещин
            updateCracks();
        }
        
        // Обновление трещин в зависимости от здоровья
        function updateCracks() {
            const blockData = blocks[currentBlock];
            const healthPercent = currentHealth / blockData.maxHealth;
            
            // Определяем уровень трещин
            let crackLevel = 0;
            if (healthPercent < 0.33) {
                crackLevel = 2; // Много трещин
            } else if (healthPercent < 0.66) {
                crackLevel = 1; // Среднее количество трещин
            } else if (healthPercent < 1) {
                crackLevel = 0; // Мало трещин
            }
            
            // Устанавливаем прозрачность в зависимости от урона
            const opacity = 1 - healthPercent;
            
            // Устанавливаем изображение трещин
            cracksOverlay.style.backgroundImage = `url('${blockData.crackLevels[crackLevel]}')`;
            cracksOverlay.style.opacity = opacity * 0.9;
        }
        
        // Анимация получения монет над блоком
        function showCoinHitAnimation(x, y, amount) {
            const coinElement = document.createElement('div');
            coinElement.className = 'coin-hit-animation';
            coinElement.textContent = `+${amount}`;
            coinElement.style.left = `${x}px`;
            coinElement.style.top = `${y}px`;
            
            block.appendChild(coinElement);
            
            // Удаляем элемент после анимации
            setTimeout(() => {
                coinElement.remove();
            }, 1000);
        }
        
        // Получение случайного количества монет с учетом шансов
        function getRandomCoins() {
            const blockData = blocks[currentBlock];
            const baseCoinRange = blockData.coinRange;
            
            // Базовый шанс 95%, увеличивается до 100% с улучшением "Удача"
            const dropChance = luckActive ? 100 : 95;
            
            // Проверяем, выпали ли монеты
            if (Math.random() * 100 > dropChance) {
                return 0; // Монеты не выпали
            }
            
            // Определяем диапазон монет
            let minCoins = baseCoinRange.min;
            let maxCoins = baseCoinRange.max;
            
            // Увеличиваем максимальное количество монет с улучшением "Удача"
            if (luckActive) {
                maxCoins = Math.floor(maxCoins * 1.5);
            }
            
            // Генерируем случайное количество монет
            const coinsEarned = Math.floor(Math.random() * (maxCoins - minCoins + 1)) + minCoins;
            
            // Применяем множитель монет
            return Math.round(coinsEarned * coinMultiplier);
        }
        
        // Обновление счетчика монет
        function updateCoinsDisplay() {
            coinsCounter.textContent = coins.toLocaleString();
            
            // Анимация иконки монеты при получении
            const coinIcon = document.querySelector('.coin-icon');
            coinIcon.style.animation = 'coinPulse 0.3s';
            setTimeout(() => {
                coinIcon.style.animation = '';
            }, 300);
            
            // Обновляем кнопки в магазине
            updateShopButtons();
        }
        
        // Обновление кнопок магазина
        function updateShopButtons() {
            shopItems.forEach(item => {
                const btn = document.getElementById(`buy-${item.id}-btn`);
                if (btn) {
                    btn.disabled = coins < item.price || item.owned;
                    btn.textContent = item.owned ? 'Куплено' : `Купить за ${item.price} монет`;
                }
            });
        }
        
        // Запуск автокликера
        function startAutoClicker() {
            if (autoClickerInterval) {
                clearInterval(autoClickerInterval);
            }
            
            autoClickerInterval = setInterval(() => {
                if (!isBreaking) {
                    // Создаем искусственное событие клика
                    const rect = block.getBoundingClientRect();
                    const event = {
                        clientX: rect.left + rect.width / 2,
                        clientY: rect.top + rect.height / 2
                    };
                    handleBlockClick(event, true);
                    
                    // Показываем информацию об автокликере
                    autoClickerInfo.textContent = 'Автокликер сработал!';
                    autoClickerInfo.style.display = 'block';
                    autoClickerInfo.style.animation = 'autoClickerPulse 0.5s';
                    
                    setTimeout(() => {
                        autoClickerInfo.style.display = 'none';
                    }, 1000);
                }
            }, 5000); // Каждые 5 секунд
        }
        
        // Запуск регенерации
        function startRegenerationCheck() {
            if (regenerationTimer) {
                clearTimeout(regenerationTimer);
            }
            
            // Проверяем каждую секунду, не прошло ли 30 секунд без ударов
            regenerationTimer = setTimeout(() => {
                const timeSinceLastHit = Date.now() - lastHitTime;
                
                // Если прошло 30 секунд без ударов и анти-регенерация не активна
                if (timeSinceLastHit >= 30000 && !antiRegenActive && currentHealth < maxHealth && !isBreaking) {
                    // Начинаем регенерацию
                    startRegeneration();
                } else {
                    // Продолжаем проверку
                    startRegenerationCheck();
                }
            }, 1000);
        }
        
        // Начало регенерации
        function startRegeneration() {
            if (regenerationInterval) {
                clearInterval(regenerationInterval);
            }
            
            // Показываем индикатор регенерации
            regenerationIndicator.style.display = 'block';
            block.classList.add('regenerating');
            
            // Регенерация каждые 10 секунд
            regenerationInterval = setInterval(() => {
                if (currentHealth < maxHealth && !isBreaking && !antiRegenActive) {
                    // Восстанавливаем 10 здоровья
                    currentHealth = Math.min(currentHealth + 10, maxHealth);
                    
                    // Обновляем UI
                    updateUI();
                    
                    // Показываем сообщение о регенерации
                    regenerationIndicator.textContent = `+10 HP (${currentHealth}/${maxHealth})`;
                    
                    // Если здоровье полностью восстановлено, останавливаем регенерацию
                    if (currentHealth >= maxHealth) {
                        stopRegeneration();
                    }
                } else {
                    stopRegeneration();
                }
            }, 10000);
        }
        
        // Остановка регенерации
        function stopRegeneration() {
            if (regenerationInterval) {
                clearInterval(regenerationInterval);
                regenerationInterval = null;
            }
            
            // Скрываем индикатор регенерации
            regenerationIndicator.style.display = 'none';
            block.classList.remove('regenerating');
            
            // Запускаем проверку снова
            startRegenerationCheck();
        }
        
        // Покупка товара в магазине
        function buyShopItem(itemId) {
            const item = shopItems.find(item => item.id === itemId);
            if (!item || item.owned || coins < item.price) return;
            
            // Списываем монеты
            coins -= item.price;
            updateCoinsDisplay();
            
            // Активируем предмет
            item.owned = true;
            
            // Применяем эффекты предмета
            switch(itemId) {
                case 'clicker':
                    autoClickerActive = true;
                    startAutoClicker();
                    break;
                case 'damage':
                    damageMultiplier = 3;
                    break;
                case 'multiplier':
                    coinMultiplier = 2;
                    break;
                case 'antiregen':
                    antiRegenActive = true;
                    stopRegeneration();
                    break;
                case 'luck':
                    luckActive = true;
                    break;
            }
            
            // Обновляем кнопки магазина
            updateShopButtons();
            
            // Показываем сообщение об успешной покупке
            alert(`Вы успешно купили "${item.name}"!`);
        }
        
        // Начало игры
        function startGame() {
            menuScreen.style.opacity = '0';
            setTimeout(() => {
                menuScreen.style.display = 'none';
                gameScreen.style.display = 'flex';
                resetGame();
            }, 500);
        }
        
        // Сброс игры
        function resetGame() {
            currentBlock = 0;
            currentHealth = blocks[currentBlock].maxHealth;
            maxHealth = blocks[currentBlock].maxHealth;
            coins = 0;
            updateCoinsDisplay();
            updateUI();
            createBlockSVG();
            lastHitTime = Date.now();
            startRegenerationCheck();
        }
        
        // Обновление интерфейса
        function updateUI() {
            const blockData = blocks[currentBlock];
            clickCounter.textContent = `Здоровье: ${currentHealth}/${blockData.maxHealth}`;
            blockName.textContent = blockData.name;
            
            // Обновление прогресс-бара
            const progressPercent = (currentHealth / blockData.maxHealth) * 100;
            progressBar.style.width = `${progressPercent}%`;
            
            // Обновление цвета прогресс-бара в зависимости от здоровья
            if (progressPercent > 50) {
                progressBar.style.background = "linear-gradient(to right, #4CAF50, #8BC34A)";
            } else if (progressPercent > 25) {
                progressBar.style.background = "linear-gradient(to right, #FF9800, #FFC107)";
            } else {
                progressBar.style.background = "linear-gradient(to right, #F44336, #FF5722)";
            }
            
            // Обновление отображения здоровья
            healthDisplay.textContent = `❤️ ${currentHealth} / ${blockData.maxHealth}`;
            
            // Обновление трещин
            updateCracks();
        }
        
        // Обработка клика по блоку
        function handleBlockClick(event, isAutoClick = false) {
            if (isBreaking) return;
            
            // Обновляем время последнего удара
            lastHitTime = Date.now();
            
            // Если регенерация активна, останавливаем ее
            if (regenerationInterval) {
                stopRegeneration();
            }
            
            // Получаем координаты клика для анимации монет
            const rect = block.getBoundingClientRect();
            let x, y;
            
            if (isAutoClick) {
                // Для автокликера - центр блока
                x = rect.width / 2;
                y = rect.height / 2;
            } else {
                // Для ручного клика - место касания
                x = event.clientX - rect.left;
                y = event.clientY - rect.top;
            }
            
            // Вычисляем урон с учетом множителя
            const damage = 1 * damageMultiplier;
            currentHealth -= damage;
            
            // Получаем монеты за удар (с шансом 95%)
            const coinsEarned = getRandomCoins();
            if (coinsEarned > 0) {
                coins += coinsEarned;
                updateCoinsDisplay();
                
                // Показываем анимацию получения монет над блоком
                showCoinHitAnimation(x, y, coinsEarned);
            }
            
            // Визуальный эффект удара
            if (!isAutoClick) {
                block.classList.add('hit');
                setTimeout(() => {
                    block.classList.remove('hit');
                }, 100);
            }
            
            // Проверка, сломан ли блок
            if (currentHealth <= 0) {
                isBreaking = true;
                
                // Дополнительная награда за разрушение блока (гарантированно)
                const bonusCoins = Math.floor(blocks[currentBlock].maxHealth / 10);
                coins += bonusCoins;
                updateCoinsDisplay();
                
                // Показываем анимацию бонусных монет
                showCoinHitAnimation(rect.width / 2, rect.height / 2, `Бонус +${bonusCoins}`);
                
                // Анимация разрушения блока
                block.style.animation = 'breakBlock 0.5s forwards';
                
                // Переход к следующему блоку
                setTimeout(() => {
                    currentBlock++;
                    
                    // Если блоки закончились, начинаем сначала
                    if (currentBlock >= blocks.length) {
                        currentBlock = 0;
                    }
                    
                    // Установка нового блока
                    currentHealth = blocks[currentBlock].maxHealth;
                    maxHealth = blocks[currentBlock].maxHealth;
                    
                    // Сброс анимации
                    block.style.animation = '';
                    isBreaking = false;
                    
                    // Обновление UI и создание нового блока
                    updateUI();
                    createBlockSVG();
                    
                    // Обновляем время последнего удара
                    lastHitTime = Date.now();
                }, 500);
            } else {
                updateUI();
            }
            
            // Запускаем проверку регенерации снова
            startRegenerationCheck();
        }
        
        // Показать/скрыть модальное окно конфиденциальности
        function togglePrivacyModal() {
            privacyModal.style.display = privacyModal.style.display === 'flex' ? 'none' : 'flex';
        }
        
        // Показать/скрыть магазин
        function toggleShop() {
            if (shopScreen.style.display === 'flex') {
                shopScreen.style.display = 'none';
                gameScreen.style.display = 'flex';
            } else {
                shopScreen.style.display = 'flex';
                gameScreen.style.display = 'none';
                updateShopButtons();
            }
        }
        
        // Инициализация игры
        function init() {
            // Начальная настройка
            createBlockSVG();
            
            // События
            playBtn.addEventListener('click', startGame);
            shopBtn.addEventListener('click', toggleShop);
            backBtn.addEventListener('click', toggleShop);
            
            // Обработка кликов по блоку (только при нажатии, а не при отпускании)
            block.addEventListener('mousedown', function(event) {
                if (!isTouching) {
                    isTouching = true;
                    handleBlockClick(event);
                }
            });
            
            block.addEventListener('mouseup', function() {
                isTouching = false;
            });
            
            block.addEventListener('mouseleave', function() {
                isTouching = false;
            });
            
            // Обработка касаний для мобильных устройств
            block.addEventListener('touchstart', function(e) {
                e.preventDefault();
                if (!isTouching) {
                    isTouching = true;
                    const touch = e.touches[0];
                    const event = {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    };
                    handleBlockClick(event);
                }
            });
            
            block.addEventListener('touchend', function(e) {
                e.preventDefault();
                isTouching = false;
            });
            
            block.addEventListener('touchcancel', function() {
                isTouching = false;
            });
            
            privacyBtn.addEventListener('click', togglePrivacyModal);
            closeModalBtn.addEventListener('click', togglePrivacyModal);
            
            // События магазина
            buyClickerBtn.addEventListener('click', () => buyShopItem('clicker'));
            buyDamageBtn.addEventListener('click', () => buyShopItem('damage'));
            buyMultiplierBtn.addEventListener('click', () => buyShopItem('multiplier'));
            buyAntiregenBtn.addEventListener('click', () => buyShopItem('antiregen'));
            buyLuckBtn.addEventListener('click', () => buyShopItem('luck'));
            
            // Закрытие модального окна при клике вне его
            window.addEventListener('click', (event) => {
                if (event.target === privacyModal) {
                    togglePrivacyModal();
                }
            });
            
            // Для мобильных устройств: предотвращение масштабирования при двойном тапе
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            
            // Предотвращение контекстного меню на блоке
            block.addEventListener('contextmenu', (e) => e.preventDefault());
        }
        
        // Запуск игры при загрузке страницы
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>